<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Meal Plan Magic</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(135deg, #fff7e6 0%, #ffe8cc 100%);
      color: #4a2c0f;
      line-height: 1.6;
    }

    /* Header */
    header {
      background-color: #ff9800;
      padding: 20px;
      text-align: center;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    header h1 {
      font-size: 2.5rem;
      color: #fff;
      margin-bottom: 10px;
    }

    nav {
      margin-top: 10px;
    }

    nav a {
      color: #fff;
      text-decoration: none;
      margin: 0 15px;
      font-size: 1.1rem;
      font-weight: 500;
      transition: color 0.3s ease;
    }

    nav a:hover {
      color: #ffe0b2;
    }

    /* Main Content */
    main {
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 20px;
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
    }

    /* Left Section: Ingredients Input */
    .ingredients-section {
      flex: 1;
      min-width: 300px;
      background-color: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .ingredients-section h3 {
      font-size: 1.5rem;
      margin-bottom: 15px;
      color: #d35400;
    }

    .search-bar {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
    }

    .search-bar input {
      flex: 1;
      padding: 10px;
      font-size: 1rem;
      border: 2px solid #dcdcdc;
      border-radius: 5px 0 0 5px;
      outline: none;
    }

    .search-bar button {
      padding: 10px 15px;
      background-color: #ff9800;
      color: #fff;
      border: none;
      border-radius: 0 5px 5px 0;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    .search-bar button:hover {
      background-color: #e68a00;
    }

    .ingredients-list {
      margin-bottom: 20px;
    }

    .ingredients-list p {
      font-size: 1rem;
      color: #4a2c0f;
      margin-bottom: 5px;
    }

    .generate-btn {
      width: 100%;
      padding: 12px;
      background-color: #ff9800;
      color: white;
      font-size: 1.1rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    .generate-btn:hover {
      background-color: #e68a00;
    }

    /* Right Section: Recipe Names */
    .recipes-list {
      flex: 1;
      min-width: 300px;
      background-color: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .recipes-list h3 {
      font-size: 1.5rem;
      margin-bottom: 15px;
      color: #d35400;
    }

    .recipes-list ul {
      list-style: none;
    }

    .recipes-list li {
      padding: 10px;
      margin-bottom: 10px;
      background-color: #fff7e6;
      border: 1px solid #ffe0b2;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    .recipes-list li:hover {
      background-color: #ffe0b2;
    }

    /* Recipe Details Section */
    .recipe-details {
      width: 100%;
      background-color: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      margin-top: 20px;
    }

    .recipe-details h3 {
      font-size: 1.5rem;
      margin-bottom: 15px;
      color: #d35400;
    }

    .recipe-details p {
      white-space: pre-wrap;
      color: #4a2c0f;
    }

    .error {
      color: #c0392b;
      font-weight: 500;
    }

    /* Footer */
    footer {
      background-color: #4a2c0f;
      color: #fff;
      text-align: center;
      padding: 20px;
      font-size: 0.9rem;
    }

    footer a {
      color: #ff9800;
      text-decoration: none;
    }

    footer a:hover {
      text-decoration: underline;
    }

    @media (max-width: 768px) {
      main {
        flex-direction: column;
      }
      .ingredients-section, .recipes-list {
        flex: none;
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <h1>Meal Plan Magic</h1>
    <nav>
      <a href="#home">Home</a>
      <a href="#recipes">Recipes</a>
      <a href="#about">About</a>
    </nav>
  </header>

  <!-- Main Content -->
  <main>
    <!-- Ingredients Section -->
    <section class="ingredients-section">
      <h3>Ingredients</h3>
      <div class="search-bar">
        <input type="text" id="ingredient-input" placeholder="e.g., chicken, rice, broccoli">
        <button type="button" onclick="addIngredient()">Add</button>
      </div>
      <div class="ingredients-list" id="ingredients-list">
        <!-- Ingredients will be added here dynamically -->
      </div>
      <button class="generate-btn" onclick="generateRecipes()">Generate</button>
    </section>

    <!-- Recipes List Section -->
    <section class="recipes-list">
      <h3>Names of the Recipes</h3>
      <ul id="recipe-names">
        <!-- Recipe names will be added here dynamically -->
      </ul>
    </section>

    <!-- Recipe Details Section -->
    <section class="recipe-details" id="recipe-details">
      <h3>You've Chosen the [Title of the Recipe]</h3>
      <p id="recipe-instructions">Instructions will appear here after selecting a recipe.</p>
    </section>
  </main>

  <!-- Footer -->
  <footer>
    <p>© 2025 Meal Plan Magic. Made with ❤️ for food lovers.</p>
    <p><a href="#home">Home</a> | <a href="#recipes">Recipes</a> | <a href="#about">About</a></p>
  </footer>

  <!-- JavaScript -->
  <script>
    let ingredients = [];
    let recipes = [];

    // Add ingredient to the list
    function addIngredient() {
      const input = document.getElementById('ingredient-input');
      const ingredient = input.value.trim();
      if (ingredient) {
        ingredients.push(ingredient);
        input.value = '';
        updateIngredientsList();
      }
    }

    // Update the displayed ingredients list
    function updateIngredientsList() {
      const list = document.getElementById('ingredients-list');
      list.innerHTML = ingredients.length ? ingredients.map((item, index) => `<p>${index + 1}. ${item}</p>`).join('') : '<p>No ingredients added yet.</p>';
    }

    // Generate recipes by calling the API
    async function generateRecipes() {
      if (ingredients.length === 0) {
        alert('Please add at least one ingredient.');
        return;
      }

      const resultDiv = document.getElementById('recipe-details');
      const recipeNamesList = document.getElementById('recipe-names');
      resultDiv.classList.remove('error');

      try {
        const response = await fetch('/get-recipes', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ ingredients: ingredients.join(', ') })
        });
        const data = await response.json();

        if (response.ok) {
          // Parse the response into a list of recipes
          const recipeText = data.recipes || 'No recipes returned';
          recipes = parseRecipes(recipeText);
          updateRecipeNames();
          // Clear the details section until a recipe is selected
          document.getElementById('recipe-details').innerHTML = '<h3>Select a recipe to view details</h3>';
        } else {
          resultDiv.innerText = data.error || 'An unexpected error occurred';
          resultDiv.classList.add('error');
        }
      } catch (error) {
        console.error('Fetch error:', error);
        resultDiv.innerText = 'Failed to connect to the server: ' + error.message;
        resultDiv.classList.add('error');
      }
    }

    // Parse the API response into a list of recipes (simplified)
    function parseRecipes(text) {
      const lines = text.split('\n').filter(line => line.trim());
      const parsedRecipes = [];
      let currentRecipe = null;

      lines.forEach(line => {
        if (/^\d+\.\s/.test(line)) {
          if (currentRecipe) parsedRecipes.push(currentRecipe);
          currentRecipe = { name: line.replace(/^\d+\.\s/, '').trim(), instructions: '' };
        } else if (currentRecipe) {
          currentRecipe.instructions += line + '\n';
        }
      });

      if (currentRecipe) parsedRecipes.push(currentRecipe);
      return parsedRecipes;
    }

    // Update the list of recipe names
    function updateRecipeNames() {
      const list = document.getElementById('recipe-names');
      list.innerHTML = recipes.length
        ? recipes.map((recipe, index) => `<li onclick="showRecipe(${index})">${index + 1}. ${recipe.name}</li>`).join('')
        : '<li>No recipes found.</li>';
    }

    // Show the selected recipe's details
    function showRecipe(index) {
      const recipe = recipes[index];
      const detailsDiv = document.getElementById('recipe-details');
      detailsDiv.innerHTML = `
        <h3>You've Chosen the "${recipe.name}"</h3>
        <p>Instructions:<br>${recipe.instructions}</p>
      `;
    }
  </script>
</body>
</html>
